<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PaperRatCrafts</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/x-icon" href="/images/Logo_trans.png">
  <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>

<div class="wrap">
  <header>
    <h1>Paper Rat Crafts</h1>
    <p class="muted">Undecided-medium artist</p>
  </header>

  <!-- Category menu (buttons are created by JavaScript) -->
  <nav class="menu" id="categoryMenu" aria-label="Art categories"></nav>

  <!-- Gallery: sideways thumbnails (one-row scroll) + preview + details -->
  <section class="gallery-area" aria-label="Gallery area">
    <div>
      <div class="thumbnails" id="thumbnails" aria-live="polite">
        <!-- Thumbnails are injected here -->
      </div>

      <div class="preview">
        <div style="flex:1;">
          <img id="selectedImage" alt="Selected artwork" src="images/Logo_profiil.png">
        </div>
        <aside class="details-panel">
          <div style="font-weight:600">Image details</div>

          <div id="noSelection" class="placeholder" style="margin-top:8px">
            Click a thumbnail to view details and edit.
          </div>

          <div id="detailsForm" style="display:none">
            <label for="imgTitle">Title</label>
            <input id="imgTitle" type="text" placeholder="Title">

            <label for="imgDate">Date</label>
            <input id="imgDate" type="date">

            <label for="imgDesc">Description</label>
            <textarea id="imgDesc" placeholder="Add a description, materials, size, etc."></textarea>

            <div class="details-actions">
              <button class="btn secondary" id="clearDetails">Clear</button>
              <button class="btn" id="saveDetails">Save</button>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <!-- About me -->
  <section class="about" aria-label="About me">
    <div class="side-images" style="align-items:flex-end;">
      <img src="images/about-left-1.png" alt="left sample" onerror="this.style.visibility='hidden'">
      <img src="images/about-left-2.png" alt="left sample 2" onerror="this.style.visibility='hidden'">
    </div>

    <div style="text-align:center">
      <div>
        <img id="aboutPhoto" class="round" src="images/Logo_profiil.png" alt="About photo">
      </div>
      <div style="margin-top:12px; max-width:520px; margin-left:auto; margin-right:auto;">
        <h2>About Me</h2>
        <p class="muted">Hi — I'm PaperRatCrafts. I make a variety of art including digital pieces, physical handcrafted objects, sewing & embroidery pieces, and jewelry boxes. I don't use AI for training and I don't mint NFTs. Below you can add a short bio and update the center image by replacing the file in your repository or by using the file input below (preview only).</p>
        <div style="margin-top:8px;">
          <input id="aboutFile" type="file" accept="image/*">
        </div>
      </div>
    </div>

    <div class="side-images" style="align-items:flex-start;">
      <img src="images/about-right-1.png" alt="right sample" onerror="this.style.visibility='hidden'">
      <img src="images/about-right-2.png" alt="right sample 2" onerror="this.style.visibility='hidden'">
    </div>
  </section>

  <!-- Contact -->
  <section class="contact" aria-label="Contact">
    <h3>Contact</h3>
    <p class="muted">Email: <a href="mailto:you@example.com">you@example.com</a></p>
    <p class="muted">Instagram: <a href="https://instagram.com/" target="_blank" rel="noopener">yourhandle</a></p>
    <p class="muted">Commissions & collaborations welcome.</p>
  </section>

  <footer>
    © 2026 PaperRatCrafts · All Rights Reserved  
    <br>No AI training · No NFTs
  </footer>
</div>

<script>
/*
  Gallery settings and behavior.
  - You can let the page try to read image filenames directly from this GitHub repository
    (works for public repos via the GitHub API), or
  - Use a simple filenames list in imagesMap, or
  - Fall back to probing numbered filenames (1.jpg, 2.jpg, ...).
*/

/* --- Categories shown in the top menu --- */
const categories = [
  { label: "Digital art", folder: "digital-art" },
  { label: "Physical art", folder: "physical-art" },
  { label: "Sewing & Embroidery", folder: "sewing-embroidery" },
  { label: "Jewelry boxes", folder: "jewelry-boxes" },
  { label: "Other", folder: "other" }
];

/*
  imagesMap: optional. If you prefer to list exact filenames, put them here.
  Example:
    imagesMap["digital-art"] = ["sunset.jpg","portrait.png"];
*/
const imagesMap = {
  "digital-art": [],
  "physical-art": [],
  "sewing-embroidery": [],
  "jewelry-boxes": [],
  "other": []
};

/*
  Option A (recommended for convenience): try the GitHub API to list files in
  images/<folder>. This works for public repos and is convenient because you
  don't need to maintain a manifest. Keep in mind unauthenticated requests are
  rate-limited (60 requests per hour per IP). If you hit rate limits you can
  either switch to imagesMap or add a simple manifest.json to each folder.

  Option B: set useGitHubApi = false to skip trying the API and rely on imagesMap
  or probing.
*/
const useGitHubApi = true;
const repoOwner = "PaperRatCrafts";                  // change if different
const repoName = "paper-rat-crafts-portfolio";         // change if different
const repoBranch = "main";                           // change to your branch if needed

/* --- probing settings (fallback when names are unknown) --- */
const probeExtensions = ["jpg", "jpeg", "png", "webp", "gif"];
const probeMax = 12;

/* --- DOM refs --- */
const categoryMenu = document.getElementById('categoryMenu');
const thumbnails = document.getElementById('thumbnails');
const selectedImage = document.getElementById('selectedImage');
const detailsForm = document.getElementById('detailsForm');
const noSelection = document.getElementById('noSelection');
const imgTitle = document.getElementById('imgTitle');
const imgDate = document.getElementById('imgDate');
const imgDesc = document.getElementById('imgDesc');
const saveDetails = document.getElementById('saveDetails');
const clearDetailsBtn = document.getElementById('clearDetails');
const aboutFile = document.getElementById('aboutFile');
const aboutPhoto = document.getElementById('aboutPhoto');

let currentCategory = categories[0].folder;
let currentSrc = selectedImage.src;

/* --- Initialize menu --- */
function initMenu() {
  categories.forEach((c, idx) => {
    const btn = document.createElement('button');
    btn.textContent = c.label;
    btn.dataset.folder = c.folder;
    if (idx === 0) btn.classList.add('active');
    btn.addEventListener('click', () => {
      document.querySelectorAll('nav.menu button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      loadGallery(c.folder);
    });
    categoryMenu.appendChild(btn);
  });
}

/* --- Try to list files in a repo folder via GitHub API --- */
async function listFilesInRepoFolder(folder) {
  try {
    const api = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/images/${folder}?ref=${repoBranch}`;
    const res = await fetch(api);
    if (!res.ok) throw new Error('GitHub API error: ' + res.status);
    const data = await res.json();
    // Keep only actual files with image extensions
    return data
      .filter(item => item.type === 'file' && /\.(jpe?g|png|webp|gif)$/i.test(item.name))
      .map(item => item.name);
  } catch (err) {
    // Quietly fail and let caller fall back
    console.warn('Could not list files from GitHub API:', err.message);
    return [];
  }
}

/* --- Build the raw.githubusercontent URL for a filename in the repo --- */
function rawUrlFor(folder, filename) {
  return `https://raw.githubusercontent.com/${repoOwner}/${repoName}/${repoBranch}/images/${folder}/${filename}`;
}

/* --- Load gallery for a category --- */
async function loadGallery(folder) {
  currentCategory = folder;
  thumbnails.innerHTML = '';

  // 1) If user provided an explicit list, use that
  if (imagesMap[folder] && imagesMap[folder].length > 0) {
    imagesMap[folder].forEach(fname => addThumb(`images/${folder}/${fname}`));
  } else {
    // 2) Optionally try GitHub API to get filenames from the repo
    let files = [];
    if (useGitHubApi) {
      files = await listFilesInRepoFolder(folder);
      if (files.length > 0) {
        files.forEach(fname => addThumb(rawUrlFor(folder, fname)));
      }
    }

    // 3) If no results yet, fall back to probing numbered filenames
    if (!useGitHubApi || (useGitHubApi && files.length === 0)) {
      for (let i = 1; i <= probeMax; i++) {
        for (const ext of probeExtensions) {
          const url = `images/${folder}/${i}.${ext}`;
          addThumb(url); // images that don't exist will remove themselves on error
        }
      }
    }
  }

  // Wait a short moment and either select the first image or show helpful text
  setTimeout(() => {
    if (thumbnails.querySelectorAll('img').length === 0) {
      thumbnails.innerHTML = '<div class="placeholder" style="padding:12px">No images found for this category. Either put images in images/' + folder + ' or list filenames in the imagesMap object in the script.</div>';
      selectedImage.src = 'images/Logo_profiil.png';
      detailsForm.style.display = 'none';
      noSelection.style.display = 'block';
    } else {
      const first = thumbnails.querySelector('img');
      if (first) first.click();
    }
  }, 700);
}

/* --- Add one thumbnail element; broken images remove themselves --- */
function addThumb(src) {
  const img = document.createElement('img');
  img.src = src;
  img.alt = 'Artwork thumbnail';
  img.onerror = () => { img.remove(); };
  img.onclick = () => { selectImage(src); };
  thumbnails.appendChild(img);
}

/* --- When an image is selected, show preview and load/saveable details --- */
function selectImage(src) {
  currentSrc = src;
  selectedImage.src = src;
  const key = `art-details:${src}`;
  const saved = localStorage.getItem(key);
  if (saved) {
    const obj = JSON.parse(saved);
    imgTitle.value = obj.title || '';
    imgDate.value = obj.date || '';
    imgDesc.value = obj.description || '';
  } else {
    imgTitle.value = '';
    imgDate.value = '';
    imgDesc.value = '';
  }
  detailsForm.style.display = 'block';
  noSelection.style.display = 'none';
}

/* --- Save / clear details locally (localStorage) --- */
saveDetails.addEventListener('click', () => {
  if (!currentSrc) return;
  const key = `art-details:${currentSrc}`;
  const payload = {
    title: imgTitle.value.trim(),
    date: imgDate.value,
    description: imgDesc.value.trim(),
    savedAt: new Date().toISOString()
  };
  localStorage.setItem(key, JSON.stringify(payload));
  saveDetails.textContent = 'Saved';
  setTimeout(() => saveDetails.textContent = 'Save', 900);
});

clearDetailsBtn.addEventListener('click', () => {
  if (!currentSrc) return;
  const key = `art-details:${currentSrc}`;
  localStorage.removeItem(key);
  imgTitle.value = ''; imgDate.value = ''; imgDesc.value = '';
});

/* --- About image preview only (local, not uploaded) --- */
aboutFile.addEventListener('change', (e) => {
  const f = e.target.files && e.target.files[0];
  if (!f) return;
  const reader = new FileReader();
  reader.onload = (ev) => {
    aboutPhoto.src = ev.target.result;
  };
  reader.readAsDataURL(f);
});

/* --- Boot up --- */
initMenu();
loadGallery(currentCategory);

/* Accessibility niceties */
thumbnails.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && e.target.tagName === 'IMG') e.target.click();
});
thumbnails.addEventListener('click', (e) => {
  if (e.target.tagName === 'IMG') e.target.scrollIntoView({ behavior: 'smooth', inline: 'center' });
});
</script>

</body>
</html>
